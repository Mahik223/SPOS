import java.util.*;

public class PageReplacementAlgo {

    // LRU Page Replacement Algorithm
    private void lru() {
        Scanner sc = new Scanner(System.in);

        int pageFaults = 0, pageHits = 0;
        int[] pages = {7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 1, 2, 0};

        System.out.print("Enter Frame Size: ");
        int frameSize = sc.nextInt();

        // Set to store current pages
        HashSet<Integer> frames = new HashSet<>(frameSize);

        // Map to track the last used index of each page
        HashMap<Integer, Integer> lastUsed = new HashMap<>();

        for (int i = 0; i < pages.length; i++) {
            int page = pages[i];

            if (frames.contains(page)) {
                pageHits++;
            } else {
                // Page Fault occurs
                pageFaults++;

                // If frame is full, remove least recently used page
                if (frames.size() == frameSize) {
                    int lruPage = -1, minIndex = Integer.MAX_VALUE;
                    for (int p : frames) {
                        int last = lastUsed.get(p);
                        if (last < minIndex) {
                            minIndex = last;
                            lruPage = p;
                        }
                    }
                    frames.remove(lruPage);
                }
                frames.add(page);
            }

            // Update last used index
            lastUsed.put(page, i);

            System.out.println("Step " + (i + 1) + ": " + frames);
        }

        System.out.println("\nTotal Page Faults: " + pageFaults);
        System.out.println("Total Page Hits: " + pageHits);
    }

    public static void main(String[] args) {
        PageReplacementAlgo algo = new PageReplacementAlgo();
        algo.lru();
    }
}



************************************** T H E O R Y ***************************************************

Concept:

In LRU Page Replacement, when a new page needs to be loaded into memory and all frames are full,
â¡ï¸ we remove the page that has not been used for the longest time (least recently used).

âš™ï¸ Program Steps:

Input:

Frame size (number of memory slots).

A fixed reference string (pages to be accessed):
{7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 1, 2, 0}

Data Structures:

HashSet<Integer> frames: keeps the current pages in memory.

HashMap<Integer, Integer> lastUsed: stores when each page was last accessed.

For each page:

If page is already in memory, itâ€™s a page hit.

If page is not in memory, itâ€™s a page fault.

If the frame is full:

Remove the least recently used page (the one with smallest last-used index).

Add the new page.

Update last used time for every page access.

At the end:

Display total page faults and hits.

ğŸ§® Example Output:
Enter Frame Size: 3
Step 1: [7]
Step 2: [0, 7]
Step 3: [0, 1, 7]
Step 4: [0, 1, 2]
Step 5: [0, 1, 2]
Step 6: [0, 3, 2]
Step 7: [0, 3, 2]
Step 8: [4, 3, 2]
...
Total Page Faults: 9
Total Page Hits: 6

ğŸ”„ Flowchart (Text-Based)
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚        START           â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Input Frame Size       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Initialize Frames={}   â”‚
          â”‚ Initialize LastUsed={} â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ For each Page in list  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Page in Frames?             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          Yes â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ No
           â”‚                        â”‚
           â–¼                        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Page Hit++ â”‚       â”‚ Page Fault++           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ If Frames Full â†’       â”‚
                        â”‚ Remove Least Recently   â”‚
                        â”‚ Used Page               â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Add New Page to Frame â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Update Last Used[page] = i  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Print Current Frames    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Repeat for all Pages        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Display Total Faults &  â”‚
                        â”‚ Hits                    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚          END            â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
